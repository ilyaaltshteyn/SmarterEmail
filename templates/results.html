<!doctype html>
<title>Send javascript with template demo</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>

<style>
/*THIS IS HERE FOR NOW TO AVOID HAVING TO USE
STREAM_WITH_CONTEXT WHEN RENDERING THIS TEMPLATE*/

#data {
  text-align: center;
}
.loader {
  border: 16px solid #f3f3f3; /* Light grey */
  border-top: 16px solid #3E606F; /* Dark blue */
  border-radius: 50%;
  width: 120px;
  height: 120px;
  animation: spin 2s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

</style>

<div class = "loader"></div>
<div id="data"></div>
{% for i in data: %}
<script>

  function prepData(encodedString) {
    // Decodes a string encoded as htmlspecialchars, which our data is.
    var textArea = document.createElement('textarea');
    textArea.innerHTML = encodedString;
    return JSON.parse(textArea.value);
   }

  $(".loader").hide();
  var a = prepData("{{ i }}");
  $("#data").text(a["most_common_intros"]);

</script>
{% endfor %}
